{"version":3,"sources":["../src/deletepost.js"],"names":["define","$","Ajax","Swal","DeletePost","registerEventListeners","prototype","click","event","preventDefault","eventTarget","currentTarget","fire","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","then","result","value","deletePost","bind","request","call","methodname","args","post","id","data","done","removeDiscuss","fail","error","message","showToast","discussDiv","closest","fadeOut","remove","type","Toast","mixin","toast","position","showConfirmButton","timer","timerProgressBar","onOpen","addEventListener","stopTimer","resumeTimer"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Delete post js logic.\n *\n * @package    format_timeline\n * @copyright  2020 onwards Willian Mano {@link http://conecti.me}\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'format_timeline/sweetalert'], function($, Ajax, Swal) {\n    var DeletePost = function() {\n        this.registerEventListeners();\n    };\n\n    DeletePost.prototype.registerEventListeners = function() {\n        $(\".delete-post\").click(function(event) {\n            event.preventDefault();\n\n            var eventTarget = $(event.currentTarget);\n\n            Swal.fire({\n                title: 'Você tem certeza disso?',\n                text: \"Depois de excluída a publicação não poderá ser recuperada!\",\n                icon: 'warning',\n                showCancelButton: true,\n                confirmButtonColor: '#3085d6',\n                cancelButtonColor: '#d33',\n                confirmButtonText: 'Sim, pode excluir!',\n                cancelButtonText: 'Cancelar'\n            }).then(function(result) {\n                if (result.value) {\n                    this.deletePost(eventTarget);\n                }\n            }.bind(this));\n        }.bind(this));\n    };\n\n    DeletePost.prototype.deletePost = function(eventTarget) {\n        var request = Ajax.call([{\n            methodname: 'format_timeline_deletepost',\n            args: {\n                post: {\n                    id: eventTarget.data('id')\n                }\n            }\n        }]);\n\n        request[0].done(function() {\n            this.removeDiscuss(eventTarget);\n        }.bind(this)).fail(function(error) {\n            var message = error.message;\n\n            if (!message) {\n                message = error.error;\n            }\n\n            this.showToast('error', message);\n        });\n    };\n\n    DeletePost.prototype.removeDiscuss = function(eventTarget) {\n        var discussDiv = eventTarget.closest('div.discuss');\n\n        discussDiv.fadeOut(\"normal\", function() {\n            $(this).remove();\n        });\n\n        this.showToast('success', 'Publicação excluída com sucesso.');\n    };\n\n    DeletePost.prototype.showToast = function(type, message) {\n        var Toast = Swal.mixin({\n            toast: true,\n            position: 'top-end',\n            showConfirmButton: false,\n            timer: 8000,\n            timerProgressBar: true,\n            onOpen: (toast) => {\n                toast.addEventListener('mouseenter', Swal.stopTimer);\n                toast.addEventListener('mouseleave', Swal.resumeTimer);\n            }\n        });\n\n        Toast.fire({\n            icon: type,\n            title: message\n        });\n    };\n\n    return {\n        'init': function() {\n            return new DeletePost();\n        }\n    };\n});"],"file":"deletepost.min.js"}